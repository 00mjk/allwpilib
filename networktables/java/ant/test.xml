<project name="Network_Tables_2.0 Test">
	
	<!-- test build properties -->
	<property name="test.build.dir" value="${build.dir}/test" />
	<property name="classes.test.dir" value="${test.build.dir}/classes" />
	
	
	<!-- test build -->
	<target name="compile-test" depends="build-crio,build-desktop">
		<mkdir dir="${classes.test.dir}" />
		
		<javac target="1.6" source="1.6" srcdir="" destdir="${classes.test.dir}" includeAntRuntime="false" debug="true" >
			<src path="${desktop.src.dir}"/>
			<src path="${src.dir}"/>
		</javac>
	</target>
	
	<target name="test" depends="compile-test">
		<path path="${classes.test.dir}" id="tested-desktop-classpath"/>
		<ant antfile="${sunspot.home}/test.xml">
			<property name="sunspot.home" value="${sunspot.home}" />
			<property name="crio.test.alternate.networktables.archive" value="${dist.dir}/lib/${crio.dist.filename}" />
			<property name="test.build.dir" value="${test.build.dir}" />
			<reference refid="tested-desktop-classpath"/>
			<target name="test"/>
		</ant>
	</target>
	
	<target name="test-desktop" depends="compile-test">
		<path path="${classes.test.dir}" id="tested-desktop-classpath"/>
		<ant antfile="${sunspot.home}/test.xml">
			<property name="sunspot.home" value="${sunspot.home}" />
			<property name="test.build.dir" value="${test.build.dir}" />
			<reference refid="tested-desktop-classpath"/>
			<target name="test-desktop"/>
		</ant>
	</target>
	
	
	<target name="dist-tests">
		<mkdir dir="${dist.dir}/tests" />
		<zip destfile="${dist.dir}/tests/networktables.tests.zip">
			<fileset dir="." includes="desktop-test/**"/>
			<fileset dir="." includes="crio-test/**"/>
		</zip>
	</target>
</project>